# Домашняя работа по Рекомендательным системам

## Косарева Екатерина (DS-22)


**Рекомендации, блокноты для построения и анализа  рекомендаций в папке hw_notebook**
**Основная идея**:

Я взяла нейросетевой рекомендер для предсказываения трека по предыдущему треку. Добавила в модель эмбэдинги для юзеров и обучала функцию:

$$rate = F(start, track, user),$$

$$F(start, track, user) = (start\_embedding + user\_embedding) * track\_embedding$$

**Другие изменения**:

EMBEDDING_SIZE = 64

LEARNING_RATE = 0.05

BATCH_SIZE = 2048

NUM_EPOCHS = 300


**Файл json с рекомендациями имеет такую же струтуру как и рекомендации построенные на семинаре 4, поэтому для запуска симуляции в проекте botify моджно использовать скрипт contextual.py, просто прописав в config.json путь к рекомендациям "TRACKS_CATALOG": "./data/my_nn_v4.json",**

**Замечание**: 
Пробовала добавлять голову в сеть (несколько полносвязанных слоев с релу и дропаутом), но это никак не помогло улучшить модель. 

Рекомендации на основе совместной фильтрации с использованием косинусного сходства и подбором threshold для степени сходства + рекомендации топ5 трэков "любимых" исполнителей дали результат значительно хуже :(


**Выводы**:
По результатам эксперимента больше всего на точность модели влиял выбор начального learning rate и размера эмбэдинга 


# Ноутбуки для составления и анализа рекомендаций

**my_nn_recomender.ipynb** - ноутбук для построения рекомендаций

**my_nn_v4.json** - построенные рекомендации

**my_recs_v4.json** - результаты симуляции на основе построенных рекомендаций  **my_nn_v4.json**

**recommenders comparison.ipynb** - сравнение статистик для контрольного и моего рекомендера

**results.png** - табличка


<image src="results.png" alt="Таблица с результатами">

